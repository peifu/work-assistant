{% extends "layouts/base.html" %}

{% block title %} Project {% endblock %}

<!-- Element injected in the BODY element -->
{% block body_class %} sidebar-mini pace-primary {% endblock body_class %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}


<link rel="stylesheet" href="static/assets/css/jsmind.css" />
<link rel="stylesheet" href="static/assets/lib/layui-v2.6.3/css/layui.css" media="all">
<!-- Google Font: Source Sans Pro -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
<!-- Font Awesome -->
<link rel="stylesheet" href="static/assets/plugins/fontawesome-free/css/all.min.css">
<!-- pace-progress -->
<link rel="stylesheet" href="static/assets/plugins/pace-progress/themes/black/pace-theme-flat-top.css">
<!-- adminlte-->
<link rel="stylesheet" href="static/assets/css/adminlte.min.css">

<style type="text/css">
    button {
        padding: 0.5rem 1rem;
        font-size: 1rem;
    }

    #jsmind_container {
        /*width: 1600px;*/
        height: 760px;
        border: solid 1px #ccc;
        background: #f4f4f4;
    }
</style>

{% endblock stylesheets %}

{% block content %}

<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1>Project</h1>
                </div>
            </div>
        </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="layui-btn-radius">
            <button type="button" id="btn_collapse" class="btn btn-primary">Collapse</button>
            <button type="button" id="btn_expand" class="btn btn-primary">Expand</button>
        </div>

        <div id="jsmind_container" style="margin-top: 10px;"></div>

    </section>
    <!-- /.content -->
</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<!-- jQuery -->
<script src="static/assets/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="static/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- pace-progress -->
<script src="static/assets/plugins/pace-progress/pace.min.js"></script>
<!-- AdminLTE App -->
<script src="static/assets/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="static/assets/js/demo.js"></script>

<script type="text/javascript" src="static/assets/js/jsmind.js"></script>
<script type="text/javascript" src="static/assets/lib/layui-v2.6.3/layui.js"></script>
<script type="text/javascript" src="static/assets/lib/jquery-3.4.1/jquery-3.4.1.min.js"></script>
<script type="text/javascript">

    var project_data = $.getJSON('static/assets/data/project.json', function (data) {
        update_project(data);
    });
    var mind = {
        meta: {
            name: 'demo',
        },
        format: 'node_tree',
        data: {
            "id": "0",
            "topic": "Project",
            "children": project_data,
        },
    };

    var options = {
        container: 'jsmind_container',
        mode: 'full',
        support_html: true,
        //editable: true,
        theme: 'info',
        view: {
            engine: 'svg',
        },
    };
    var expand_depth = 1;
    var jm = new jsMind(options);
    jm.show(mind);
    jm.expand_to_depth(expand_depth);

    $('#btn_collapse').click(function () {
        console.log('btn_collapse');
        expand_depth--;
        if (expand_depth < 1)
            expand_depth = 1;
        jm.expand_to_depth(expand_depth);
    });
    $('#btn_expand').click(function () {
        console.log('btn_expand');
        expand_depth++;
        if (expand_depth > 3)
            expand_depth = 3;
        jm.expand_to_depth(expand_depth);
    });
    function node_info_show(info) {
        layer.msg(info, { icon: 6, time: 3000, shift: 5, offset: ['200px', '280px'], area: '300px' });
    }
    function update_project(data) {
        mind.data.children = data;
        jm.show(mind);
        jm.expand_to_depth(expand_depth);
    }
    $('#jsmind_container').click(function () {
        console.log('container click');
        node = jm.get_selected_node();
        if (node) {
            console.log(node.id);
            info = "ID: " + node.id;
            info += "</br>Project: " + node.topic;
            if (node.data['statement']) {
                info += "</br>Comment: " + node.data['statement'];
            }
            node_info_show(info);
        }
    });

</script>

{% endblock javascripts %}